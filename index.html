<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>wait.. how does thing internet thing work?</title>
<style>
*{font-family:Segoe UI,Tahoma;margin:0;padding:0;box-sizing:border-box}
body{height:100vh;background:linear-gradient(#cfe4ff,#8fb3e8)}
.screen{display:none;width:100%;height:100%;position:absolute}
.vista{
display:flex;align-items:center;justify-content:center;
background:radial-gradient(circle at top,#ffffff,#7fa6d8)
}
.glass{
width:420px;padding:30px;border-radius:10px;
background:rgba(255,255,255,.7);
box-shadow:0 0 25px rgba(0,0,0,.3);
text-align:center
}
.glass h1{font-size:32px;color:#003a8c;margin-bottom:20px}
.glass button{width:100%;padding:12px;margin:8px 0;border:none;
background:linear-gradient(#4c8bf5,#1f5fd1);
color:#fff;font-weight:bold;border-radius:6px;cursor:pointer}
.auth{background:#fff;width:380px;margin:auto;margin-top:80px;
padding:30px;border-radius:6px;box-shadow:0 0 12px rgba(0,0,0,.3);
text-align:center}
.auth input,.auth button{width:100%;padding:10px;margin-bottom:10px}
.auth button{background:#0078d7;color:#fff;border:none;font-weight:bold}
#container{display:flex;height:100%}
#sidebar{width:260px;background:#f1f6fb;border-right:1px solid #bbb;padding:10px}
#contacts,.contact-list{overflow-y:auto}
.contact{padding:6px;border-bottom:1px solid #ccc;cursor:pointer}
.contact:hover{background:#d9e9ff}
#chat{flex:1;display:flex;flex-direction:column}
#header{padding:10px;background:#e3efff;border-bottom:1px solid #aaa;
display:flex;justify-content:space-between}
#messages{flex:1;padding:10px;background:#eef4ff;overflow-y:auto}
.msg{margin-bottom:6px;padding:6px 10px;border-radius:6px;
background:#d7e7ff;max-width:70%}
.self{background:#0078d7;color:white;margin-left:auto}
#send{display:flex;padding:10px;border-top:1px solid #aaa}
#send input{flex:1;padding:8px}
#send button{padding:8px 14px;background:#0078d7;color:#fff;border:none}
#settings{
display:none;position:absolute;top:50%;left:50%;
transform:translate(-50%,-50%);
background:#f1f6fb;padding:25px;border-radius:8px;width:520px
}
.setting{margin-bottom:18px}
.setting button{margin:4px;padding:6px 12px;border:none;
background:#0078d7;color:white}
.delete{background:#a00}
</style>
</head>
<body>

<div id="welcome" class="screen vista">
<div class="glass">
<h1>Delemencia</h1>
<button onclick="show('login')">Sign in</button>
<button onclick="show('register')">Create account</button>
</div>
</div>

<div id="register" class="screen">
<div class="auth">
<h2>Create account</h2>
<input id="ru" placeholder="Username">
<input id="rp" type="password" placeholder="Password">
<button onclick="register()">Create</button>
</div>
</div>

<div id="login" class="screen">
<div class="auth">
<h2>Sign in</h2>
<input id="lu" placeholder="Username">
<input id="lp" type="password" placeholder="Password">
<button onclick="login()">Sign in</button>
</div>
</div>

<div id="main" class="screen">
<div id="container">
<div id="sidebar">
<input id="addUser" placeholder="Add user">
<button onclick="addContact()">Add</button>
<h4>Contacts</h4>
<div id="contacts"></div>
</div>

<div id="chat">
<div id="header">
<span id="chatName">Select chat</span>
<button onclick="openSettings()">âš™</button>
</div>
<div id="messages"></div>
<div id="send">
<input id="msg">
<button onclick="send()">Send</button>
</div>
</div>
</div>
</div>

<div id="settings">
<h2>Settings</h2>

<div class="setting">
<h4>Status</h4>
<select id="status" onchange="setStatus()">
<option>Online</option>
<option>Away</option>
<option>Busy</option>
<option>Invisible</option>
</select>
</div>

<div class="setting">
<h4>Profile picture</h4>
<input type="file" accept="image/*" onchange="pic(event)">
</div>

<div class="setting">
<h4>Ignore user</h4>
<input id="ignoreUser" placeholder="Username">
<button onclick="ignore()">Ignore</button>
</div>

<div class="setting">
<button onclick="logout()">Logout</button>
<button class="delete" onclick="del()">Delete account</button>
<button onclick="closeSettings()">Back</button>
</div>
</div>

<script>
let me=null,chat=null
const db=()=>JSON.parse(localStorage.db||"{}")
const save=d=>localStorage.db=JSON.stringify(d)

function show(x){
document.querySelectorAll(".screen").forEach(s=>s.style.display="none")
document.getElementById(x).style.display="block"
}

function register(){
let u=ru.value.trim(),p=rp.value
let d=db()
if(!u||!p||d[u])return alert("Invalid")
if(u==="Delemencia"&&d["Delemencia"])return alert("Name taken")
d[u]={pass:p,admin:u==="Delemencia",contacts:[],msgs:{},
ignored:[],status:"Online",pic:"",warns:0,banned:false}
save(d);localStorage.me=u;me=u;load()
}

function login(){
let d=db()
if(!d[lu.value]||d[lu.value].pass!==lp.value)return alert("Wrong")
if(d[lu.value].banned)return alert("You are banned")
me=lu.value;localStorage.me=me;load()
}

function load(){show("main");renderContacts()}

function addContact(){
let u=addUser.value.trim(),d=db()
if(!d[u]||u===me||d[me].ignored.includes(u))return
if(!d[me].contacts.includes(u))d[me].contacts.push(u)
save(d);renderContacts()
}

function renderContacts(){
let d=db(),c=document.getElementById("contacts")
c.innerHTML=""
d[me].contacts.forEach(u=>{
if(d[me].ignored.includes(u))return
let div=document.createElement("div")
div.className="contact"
div.innerHTML=(u==="Delemencia"?"ðŸ‘‘ ":"")+u+" ("+d[u].status+")"
div.onclick=()=>{chat=u;chatName.textContent=div.textContent;renderMsgs()}
c.appendChild(div)
})
}

function send(){
if(!chat||!msg.value)return
let d=db()
if(d[chat].ignored.includes(me))return
d[me].msgs[chat]??=[]
d[chat].msgs[me]??=[]
let m={f:me,t:msg.value}
d[me].msgs[chat].push(m)
d[chat].msgs[me].push(m)
msg.value=""
save(d);renderMsgs()
}

function renderMsgs(){
let d=db(),m=document.getElementById("messages")
m.innerHTML=""
if(!chat)return
(d[me].msgs[chat]||[]).forEach(x=>{
let div=document.createElement("div")
div.className="msg"+(x.f===me?" self":"")
div.textContent=x.f+": "+x.t
m.appendChild(div)
})
m.scrollTop=m.scrollHeight
}

function openSettings(){settings.style.display="block"}
function closeSettings(){settings.style.display="none"}

function ignore(){
let u=ignoreUser.value.trim(),d=db()
if(d[u]&&!d[me].ignored.includes(u))d[me].ignored.push(u)
save(d);renderContacts()
}

function setStatus(){
let d=db()
d[me].status=status.value
save(d);renderContacts()
}

function pic(e){
let r=new FileReader()
r.onload=()=>{let d=db();d[me].pic=r.result;save(d)}
r.readAsDataURL(e.target.files[0])
}

function logout(){localStorage.removeItem("me");location.reload()}
function del(){let d=db();delete d[me];save(d);logout()}

if(localStorage.me){me=localStorage.me;load()}else show("welcome")
</script>

</body>
</html>
