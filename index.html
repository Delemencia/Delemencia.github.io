<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>let the games begin</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Tahoma}
body{height:100vh;transition:.3s}
.screen{display:none;position:absolute;width:100%;height:100%}
.vista{
display:flex;align-items:center;justify-content:center;
background:radial-gradient(circle at top,#eaffea,#4caf50)
}
.glass{
width:420px;padding:30px;border-radius:12px;
background:rgba(255,255,255,.65);
backdrop-filter:blur(6px);
box-shadow:0 0 30px rgba(0,0,0,.35);
text-align:center
}
.glass h1{font-size:34px;color:#1b5e20;margin-bottom:20px}
.glass button{
width:100%;padding:12px;margin:8px 0;border:none;
background:linear-gradient(#66bb6a,#2e7d32);
color:white;font-weight:bold;border-radius:6px;cursor:pointer
}
.auth{
background:rgba(255,255,255,.95);
width:380px;margin:auto;margin-top:90px;
padding:30px;border-radius:8px;
box-shadow:0 0 15px rgba(0,0,0,.3);
text-align:center
}
.auth input,.auth button{width:100%;padding:10px;margin-bottom:10px}
.auth button{background:#2e7d32;color:white;border:none;font-weight:bold}
#container{display:flex;height:100%}
#sidebar{
width:260px;padding:10px;
background:rgba(240,255,240,.85);
border-right:1px solid #9ccc65
}
#contacts{overflow-y:auto}
.contact{
padding:6px;border-bottom:1px solid #aed581;
cursor:pointer
}
.contact:hover{background:#c8e6c9}
#chat{flex:1;display:flex;flex-direction:column}
#header{
padding:10px;
background:rgba(220,255,220,.9);
border-bottom:1px solid #9ccc65;
display:flex;justify-content:space-between
}
#messages{
flex:1;padding:10px;
background:rgba(235,255,235,.95);
overflow-y:auto
}
.msg{
margin-bottom:6px;padding:6px 10px;
border-radius:6px;background:#c8e6c9;
max-width:70%
}
.self{background:#2e7d32;color:white;margin-left:auto}
#send{
display:flex;padding:10px;
border-top:1px solid #9ccc65
}
#send input{flex:1;padding:8px}
#send button{
padding:8px 14px;
background:#2e7d32;color:white;border:none
}
#settings{
display:none;position:absolute;
top:50%;left:50%;
transform:translate(-50%,-50%);
background:rgba(240,255,240,.95);
padding:25px;border-radius:10px;
width:560px;
box-shadow:0 0 25px rgba(0,0,0,.35)
}
.setting{margin-bottom:16px}
.setting button{
margin:4px;padding:6px 12px;
border:none;border-radius:4px;
background:#2e7d32;color:white
}
.delete{background:#a00}
.notify{
position:fixed;bottom:20px;right:20px;
background:rgba(0,0,0,.75);color:white;
padding:10px 14px;border-radius:6px;
z-index:999
}
</style>
</head>
<body>

<div id="welcome" class="screen vista">
<div class="glass">
<h1>Delemencia</h1>
<button onclick="show('login')">Sign in</button>
<button onclick="show('register')">Create account</button>
</div>
</div>

<div id="register" class="screen">
<div class="auth">
<h2>Create account</h2>
<input id="ru" placeholder="Username">
<input id="rp" type="password" placeholder="Password">
<button onclick="register()">Create</button>
</div>
</div>

<div id="login" class="screen">
<div class="auth">
<h2>Sign in</h2>
<input id="lu" placeholder="Username">
<input id="lp" type="password" placeholder="Password">
<button onclick="login()">Sign in</button>
</div>
</div>

<div id="main" class="screen">
<div id="container">
<div id="sidebar">
<input id="addUser" placeholder="Add username">
<button onclick="addContact()">Add</button>
<h4>Contacts</h4>
<div id="contacts"></div>
</div>

<div id="chat">
<div id="header">
<span id="chatName">Select chat</span>
<button onclick="openSettings()">‚öô</button>
</div>
<div id="messages"></div>
<div id="send">
<input id="msg">
<button onclick="send()">Send</button>
</div>
</div>
</div>
</div>

<div id="settings">
<div style="text-align:right">
<button onclick="minimize()">‚ûñ</button>
<button onclick="closeSettings()">‚ùå</button>
</div>

<div class="setting">
<h4>Theme</h4>
<button onclick="theme('aero')">Aero Green</button>
<button onclick="theme('blue')">Aero Blue</button>
<button onclick="theme('glass')">Glass</button>
<button onclick="theme('dark')">Dark</button>
<button onclick="theme('crimson')">Crimson</button>
<button onclick="theme('amber')">Amber</button>
<button onclick="theme('midnight')">Midnight</button>
</div>

<div class="setting">
<h4>Status</h4>
<select id="status" onchange="setStatus()">
<option>Online</option>
<option>Away</option>
<option>Busy</option>
<option>Invisible</option>
</select>
</div>

<div class="setting">
<h4>Ignore user</h4>
<input id="ignoreUser" placeholder="Username">
<button onclick="ignore()">Ignore</button>
</div>

<div class="setting">
<button onclick="callUser()">üìû Call selected</button>
<button onclick="banUser()">üî® Ban user</button>
</div>

<div class="setting">
<button onclick="logout()">Logout</button>
<button class="delete" onclick="del()">Delete account</button>
</div>
</div>

<script>
let me=null,chat=null,min=false
const db=()=>JSON.parse(localStorage.db||"{}")
const save=d=>localStorage.db=JSON.stringify(d)

function notify(t){
let n=document.createElement("div")
n.className="notify"
n.textContent=t
document.body.appendChild(n)
setTimeout(()=>n.remove(),2500)
}

function show(x){
document.querySelectorAll(".screen").forEach(s=>s.style.display="none")
document.getElementById(x).style.display="block"
}

function register(){
let u=ru.value.trim(),p=rp.value,d=db()
if(!u||!p)return notify("Invalid")
if(u==="Delemencia"&&d["Delemencia"])return notify("Name taken")
if(d[u])return notify("Username exists")
d[u]={pass:p,admin:u==="Delemencia",contacts:[],msgs:{},ignored:[],status:"Online",banned:false}
save(d);localStorage.me=u;me=u;load()
}

function login(){
let d=db(),u=lu.value
if(!d[u]||d[u].pass!==lp.value)return notify("Wrong login")
if(d[u].banned)return notify("You are banned")
me=u;localStorage.me=u;load()
}

function load(){show("main");renderContacts()}

function addContact(){
let u=addUser.value.trim(),d=db()
if(!u||!d[u])return notify("User does not exist")
if(u===me)return notify("Cannot add yourself")
if(d[me].contacts.includes(u))return notify("Already added")
d[me].contacts.push(u)
save(d);addUser.value="";renderContacts();notify("Added "+u)
}

function renderContacts(){
let d=db(),c=contacts;c.innerHTML=""
d[me].contacts.forEach(u=>{
if(d[me].ignored.includes(u))return
let div=document.createElement("div")
div.className="contact"
div.innerHTML=(u==="Delemencia"?"üëë ":"")+u+" ("+d[u].status+")"
div.onclick=()=>{chat=u;chatName.textContent=div.textContent;renderMsgs()}
c.appendChild(div)
})
}

function send(){
if(!chat||!msg.value)return
let d=db()
if(d[chat].ignored.includes(me))return notify("You are ignored")
d[me].msgs[chat]??=[]
d[chat].msgs[me]??=[]
let m={f:me,t:msg.value}
d[me].msgs[chat].push(m)
d[chat].msgs[me].push(m)
msg.value=""
save(d);renderMsgs()
}

function renderMsgs(){
let d=db(),m=messages;m.innerHTML=""
if(!chat)return
(d[me].msgs[chat]||[]).forEach(x=>{
let div=document.createElement("div")
div.className="msg"+(x.f===me?" self":"")
div.textContent=x.f+": "+x.t
m.appendChild(div)
})
m.scrollTop=m.scrollHeight
}

function theme(t){
if(t==="aero")document.body.style.background="linear-gradient(135deg,#b9f6ca,#4caf50)"
if(t==="blue")document.body.style.background="linear-gradient(135deg,#bbdefb,#1976d2)"
if(t==="glass")document.body.style.background="linear-gradient(135deg,#e0f7fa,#80deea)"
if(t==="dark")document.body.style.background="#222"
if(t==="crimson")document.body.style.background="linear-gradient(135deg,#6a0000,#200)"
if(t==="amber")document.body.style.background="linear-gradient(135deg,#ffe082,#ff9800)"
if(t==="midnight")document.body.style.background="#0b0b0b"
}

function setStatus(){
let d=db()
d[me].status=status.value
save(d);renderContacts()
}

function ignore(){
let d=db(),u=ignoreUser.value.trim()
if(!d[u])return notify("User not found")
if(!d[me].ignored.includes(u))d[me].ignored.push(u)
save(d);renderContacts();notify("Ignored "+u)
}

function callUser(){
if(!chat)return notify("No user selected")
notify("Calling "+chat+"...")
}

function banUser(){
let d=db()
if(!d[me].admin)return notify("No permission")
if(!chat||chat==="Delemencia")return
d[chat].banned=true
save(d);notify(chat+" banned")
}

function openSettings(){settings.style.display="block"}
function closeSettings(){settings.style.display="none"}
function minimize(){settings.style.display="none";notify("Settings minimized")}
function logout(){localStorage.removeItem("me");location.reload()}
function del(){let d=db();delete d[me];save(d);logout()}

if(localStorage.me){me=localStorage.me;load()}else show("welcome")
</script>

</body>
</html>
