<!DOCTYPE html>
<html>
<head>
<title>Delemencia 1.0</title>
<link rel="icon" href="favicon.ico">
<style>
* { box-sizing:border-box; font-family:Segoe UI, Arial; }

body {
  margin:0;
  background:#1a1a1a;
  color:white;
  overflow:hidden;
}

#bg {
  position:fixed;
  inset:0;
  z-index:-1;
  background:
    repeating-linear-gradient(
      135deg,
      rgba(255,255,255,0.05) 0px,
      rgba(255,255,255,0.05) 40px,
      rgba(0,0,0,0) 40px,
      rgba(0,0,0,0) 80px
    );
  animation:bgMove 25s linear infinite;
}

@keyframes bgMove {
  from { background-position:0 0; }
  to { background-position:500px 500px; }
}

.screen {
  display:none;
  min-height:100vh;
  padding:40px;
}

.auth-box {
  width:380px;
  margin:60px auto;
  background:#222;
  padding:20px;
  border-radius:10px;
}

.auth-box h1 {
  text-align:center;
  margin-bottom:20px;
}

.auth-box input {
  width:100%;
  padding:12px;
  margin-bottom:12px;
  border:none;
  font-size:14px;
  border-radius:6px;
  background:#333;
  color:white;
}

.auth-box button {
  width:100%;
  padding:10px;
  border:none;
  background:#0078d7;
  color:white;
  cursor:pointer;
  border-radius:6px;
}

.auth-box .link {
  margin-top:10px;
  font-size:13px;
  text-align:center;
  cursor:pointer;
  text-decoration:underline;
  color:#ccc;
}

#chatApp {
  display:flex;
  height:100vh;
  background:#111;
}

#users {
  width:200px;
  background:#1e1e1e;
  overflow-y:auto;
}

.user {
  padding:10px;
  border-bottom:1px solid #333;
  cursor:pointer;
}

.user:hover {
  background:#2a2a2a;
}

#chat {
  flex:1;
  display:flex;
  flex-direction:column;
}

#messages {
  flex:1;
  padding:10px;
  overflow-y:auto;
  background:#0f0f0f;
}

.msg {
  font-size:13px;
  margin-bottom:5px;
}

#sendBox {
  display:flex;
}

#sendBox input {
  flex:1;
  padding:10px;
  border:none;
  border-radius:6px 0 0 6px;
  background:#222;
  color:white;
}

#sendBox button {
  padding:10px;
  border:none;
  background:#0078d7;
  color:white;
  cursor:pointer;
}

#settings {
  background:#111;
  color:white;
  height:100vh;
  overflow-y:auto;
}

.setting {
  background:#1e1e1e;
  padding:15px;
  margin:15px;
  border-radius:10px;
}

.setting h3 {
  margin-top:0;
}

.setting button {
  margin-top:8px;
  padding:6px;
  border:none;
  background:#0078d7;
  color:white;
  cursor:pointer;
  border-radius:6px;
}
</style>
</head>
<body>
<div id="bg"></div>

<div id="welcome" class="screen">
  <div class="auth-box">
    <h1>Delemencia</h1>
    <button onclick="show('login')">Sign in</button>
    <div class="link" onclick="show('register')">Create an account</div>
  </div>
</div>

<div id="register" class="screen">
  <div class="auth-box">
    <h1>Create account</h1>
    <input id="regUser" placeholder="Username">
    <input id="regPass" type="password" placeholder="Password">
    <button onclick="register()">Create</button>
    <div class="link" onclick="show('welcome')">Back</div>
  </div>
</div>

<div id="login" class="screen">
  <div class="auth-box">
    <h1>Sign in</h1>
    <input id="logUser" placeholder="Username">
    <input id="logPass" type="password" placeholder="Password">
    <button onclick="login()">Sign in</button>
    <div class="link" onclick="show('welcome')">Back</div>
  </div>
</div>

<div id="chatScreen" class="screen">
  <div id="chatApp">
    <div id="users"></div>
    <div id="chat">
      <div id="messages"></div>
      <div id="sendBox">
        <input id="msgInput" placeholder="Type a message">
        <button onclick="send()">Send</button>
        <button onclick="show('settings')">âš™</button>
      </div>
    </div>
  </div>
</div>

<div id="settings" class="screen">
  <div class="setting">
    <h3>Appearance</h3>
    <button onclick="setTheme('dark')">Dark</button>
    <button onclick="setTheme('nebula')">Nebula</button>
    <button onclick="setTheme('light')">Light</button>
  </div>
  <div class="setting">
    <h3>Change username</h3>
    <input id="newUser">
    <button onclick="changeUsername()">Change</button>
  </div>
  <div class="setting">
    <h3>Change password</h3>
    <input id="newPass" type="password">
    <button onclick="changePassword()">Change</button>
  </div>
  <div class="setting">
    <h3>Account</h3>
    <button onclick="deleteAccount()">Delete account</button>
    <button onclick="logout()">Logout</button>
    <button onclick="show('chatScreen')">Back</button>
  </div>
</div>

<script>
let currentUser=null
let currentChat=null
const getUsers=()=>JSON.parse(localStorage.getItem("users")||"{}")
const saveUsers=u=>localStorage.setItem("users",JSON.stringify(u))
function show(id){document.querySelectorAll(".screen").forEach(s=>s.style.display="none");document.getElementById(id).style.display="block"}
function register(){let u=regUser.value.trim(),p=regPass.value,users=getUsers();if(!u||!p||users[u])return alert("Invalid");users[u]={pass:p,msgs:{}};saveUsers(users);currentUser=u;localStorage.currentUser=u;loadChat()}
function login(){let users=getUsers(),u=logUser.value.trim(),p=logPass.value;if(!users[u]||users[u].pass!==p)return alert("Wrong login");currentUser=u;localStorage.currentUser=u;loadChat()}
function loadChat(){show("chatScreen");renderUsers();renderMsgs()}
function renderUsers(){let users=getUsers(),usersDiv=document.getElementById("users");usersDiv.innerHTML="";Object.keys(users).forEach(u=>{if(u===currentUser)return;let d=document.createElement("div");d.className="user";d.textContent=u;d.onclick=()=>{currentChat=u;renderMsgs()};usersDiv.appendChild(d)})}
function send(){if(!currentChat)return;let users=getUsers();users[currentUser].msgs[currentChat]||=[];users[currentChat].msgs[currentUser]||=[];users[currentUser].msgs[currentChat].push(currentUser+": "+msgInput.value);users[currentChat].msgs[currentUser].push(currentUser+": "+msgInput.value);msgInput.value="";saveUsers(users);renderMsgs()}
function renderMsgs(){let users=getUsers();messages.innerHTML="";(users[currentUser].msgs[currentChat]||[]).forEach(m=>{let d=document.createElement("div");d.className="msg";d.textContent=m;messages.appendChild(d)})}
function logout(){localStorage.removeItem("currentUser");currentUser=null;show("welcome")}
function deleteAccount(){let users=getUsers();delete users[currentUser];saveUsers(users);logout()}
function changePassword(){let users=getUsers();users[currentUser].pass=newPass.value;saveUsers(users);alert("Changed")}
function changeUsername(){let users=getUsers();let n=newUser.value;if(!n||users[n])return alert("Invalid");users[n]=users[currentUser];delete users[currentUser];currentUser=n;saveUsers(users);localStorage.currentUser=n;alert("Changed")}
function setTheme(t){if(t==="light")document.body.style.background="#ddd";if(t==="dark")document.body.style.background="#111";if(t==="nebula")document.body.style.background="#12002b"}
if(localStorage.currentUser){currentUser=localStorage.currentUser;loadChat()}else{show("welcome")}
</script>
</body>
</html>
